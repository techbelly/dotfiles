require 'pathname'

task :default => ["vim:bootstrap"] do
end

namespace :vim do

  task :ensure_bundle_dir do
    bundle_home = Pathname.new( ENV['HOME'] ) + '.vim' + 'bundle'
    mkdir_p bundle_home
  end

  desc "update any bundles defined in the Rakefile"
  task :bootstrap => [:ensure_bundle_dir] do

    vim_dir = Pathname.new( ENV['HOME'] ) + '.vim' 
    bundle_home = vim_dir + 'bundle'
    sh "rm -rf #{bundle_home}/vundle"
    sh "rm -rf #{bundle_home}/Vundle.vim"
    sh "git clone http://github.com/gmarik/Vundle.vim.git #{bundle_home}/Vundle.vim"
    sh "vim -u #{vim_dir}/bundles.vim +PluginInstall +q"
    sh "cd bundle/vimproc.vim && make"

  end # task :bundles

end # namespace :update
